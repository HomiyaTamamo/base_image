document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("imageInput"),t=document.getElementById("processBtn"),a=document.getElementById("imageCanvas"),n=document.getElementById("outputImage"),o=document.getElementById("imageWidth"),d=document.getElementById("imageHeight"),l=document.getElementById("blockSize"),s=a.getContext("2d");t.addEventListener("click",(()=>{if(!e.files.length)return void alert("Please select an image first!");const t=parseInt(l.value);if(isNaN(t)||t<=0)return void alert("Please enter a valid block size!");const c=e.files[0],i=new FileReader;i.onload=e=>{const l=new Image;l.onload=()=>{const e=l.width,c=l.height;o.value=e,d.value=c,a.width=e,a.height=c,s.drawImage(l,0,0,e,c);const i=s.getImageData(0,0,e,c);for(let a=0;a<c;a+=t)for(let n=0;n<e;n+=t){let o=0,d=0,l=0,s=0;for(let r=0;r<t;r++)for(let m=0;m<t;m++){const t=n+m,g=a+r;if(t<e&&g<c){const a=4*(g*e+t);o+=i.data[a],d+=i.data[a+1],l+=i.data[a+2],s++}}const r=Math.floor(o/s),m=Math.floor(d/s),g=Math.floor(l/s);for(let o=0;o<t;o++)for(let d=0;d<t;d++){const t=n+d,l=a+o;if(t<e&&l<c){const a=4*(l*e+t);i.data[a]=r,i.data[a+1]=m,i.data[a+2]=g,i.data[a+3]=255}}}s.putImageData(i,0,0);const r=a.toDataURL();n.src=r,n.style.display="block"},l.src=e.target.result},i.readAsDataURL(c)}))}));